---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
We start by unzipping the data from the GitHub repo, importing as a data frame,
and then populating a few vectors that will be useful for us later in the analysis.
```{r}
unzip('~/github/RepData_PeerAssessment1/activity.zip')
activityDF <- as.data.frame(read.table('activity.csv',
                                       header = T,
                                       sep = ",",
                                       colClasses = c("integer",
                                                      "Date",
                                                      "integer")
                                       )
                            )
uniqueDays <- as.Date(unique(activityDF$date))
intervals <- unique(activityDF$interval)
```


## What is mean total number of steps taken per day?
The mean total number of steps per day is 10766.19.
The median total number of steps per day is 10765.
```{r}
dayTotals <- numeric()
for (day in uniqueDays) {
      tempDate <- activityDF[activityDF$date == as.Date(day, origin="1970-01-01"),]
      daySum <- sum(tempDate$steps)
      dayTotals <- append(dayTotals, daySum)
}
dayMean <- mean(dayTotals, na.rm = T)
dayMedian <- median(dayTotals, na.rm = T)
print(dayMean)
```


## What is the average daily activity pattern?
The average daily activity indicates the highest level of activity to be in the late
morning and the lowest level of activity during the early morning hours that would
generally correlate with sleep.

```{r}
# Instate an empty data frame to fill with the average interval data
dailyPattern <- data.frame(intervals=integer(),
                           averages=numeric())
# Loop through the intervals and average them across all 61 days of data. Append
# results to the data frame from above
for (i in intervals){
      tempInterval <- activityDF[activityDF$interval == i,]
      intervalAverage = mean(tempInterval$steps, na.rm = T)
      dailyPattern <- rbind(dailyPattern,data.frame(intervals = i, averages = intervalAverage))
}
# Generate a plot showing the average movement per interval over the course of the day
plot(dailyPattern$intervals,
     dailyPattern$averages,
     type = "l",
     xlim = range(dailyPattern$intervals),
     xlab = c("Interval"),
     ylab = c("Average Number of Steps")
     )
# Create fucntion to find the maximum value for steps and the interval referenced,
# and then use it.
colMax <- function(data) sapply(data, max, na.rm = T)
maximum <- colMax(dailyPattern$averages)
#match(dailyPattern$averages,maximum$averages)
print(maximum)
```


## Imputing missing values
```{r}
# Find the total number of missing values
missingValueTotal <- sum(is.na(activityDF$steps))
print(missingValueTotal)
# Create a copy of the original dataframe for comparison purposes
originalDF <- activityDF
activityDF$steps[is.na(activityDF$steps)] = mean(activityDF$steps, na.rm = T)

```

## Are there differences in activity patterns between weekdays and weekends?
```{r}
# Determine the day of the week and then merge that vectory with the primary data frame
daysOfWeek <- weekdays(activityDF$date)
activityDF[,"DayOfWeek"] <- daysOfWeek

```
